# =============================================================================
# Core System Environment Variables (Simplified)
# =============================================================================

# Application
APP_NAME="RAG Core System"
APP_VERSION="1.0.0"
ENVIRONMENT="development"
DEBUG=true
LOG_LEVEL="INFO"

# Server
HOST="0.0.0.0"
PORT=7001
WORKERS=4
RELOAD=true
DOMAIN_NAME=""

# Security
JWT_SECRET_KEY="your-jwt-secret-key-change-in-production"
JWT_ALGORITHM="HS256"
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Database - Core DB
# For Docker: use postgres-core:5432
# For local development: use localhost:7433
POSTGRES_DB=core_db
POSTGRES_USER=core_user
POSTGRES_PASSWORD=core_pass
DATABASE_URL="postgresql+asyncpg://core_user:core_pass@postgres-core:5432/core_db"
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30
DATABASE_ECHO=false

# Ingest Database (Optional - for direct sync with Ingest system)
# Leave empty if you don't have Ingest system or use API-based sync
# Format: postgresql+asyncpg://user:pass@host:port/dbname
# Example: postgresql+asyncpg://ingest_reader:pass@ingest-db:5432/ingest_db
INGEST_DATABASE_URL=""
INGEST_DATABASE_POOL_SIZE=10

# Qdrant Vector Database
# For Docker: use qdrant:6333
# For local development: use localhost:7333
QDRANT_HOST="qdrant"
QDRANT_PORT=6333
QDRANT_GRPC_PORT=7334
QDRANT_API_KEY=""
QDRANT_COLLECTION="legal_documents"
QDRANT_USE_GRPC=false

# Redis
# For Docker: use redis-core:6379
# For local development: use localhost:7379
REDIS_URL="redis://redis-core:6379/0"
REDIS_PASSWORD=""
REDIS_MAX_CONNECTIONS=50
REDIS_DECODE_RESPONSES=true

# Cache Settings
CACHE_TTL_DEFAULT=3600
CACHE_TTL_QUERY=7200
CACHE_TTL_EMBEDDING=86400
SEMANTIC_CACHE_THRESHOLD=0.95

# Celery
# For Docker: use redis-core:6379
# For local development: use localhost:7379
CELERY_BROKER_URL="redis://redis-core:6379/1"
CELERY_RESULT_BACKEND="redis://redis-core:6379/2"
CELERY_TASK_SERIALIZER="json"
CELERY_RESULT_SERIALIZER="json"
CELERY_TIMEZONE="Asia/Tehran"
CELERY_ENABLE_UTC=false

# ===========================================================================
# LLM Configuration (OpenAI-Compatible API)
# ===========================================================================
# برای OpenAI:
#   LLM_BASE_URL="" (خالی بگذارید)
#   LLM_API_KEY="sk-..."
#
# برای Groq:
#   LLM_BASE_URL="https://api.groq.com/openai/v1"
#   LLM_API_KEY="gsk_..."
#
# برای Together.ai:
#   LLM_BASE_URL="https://api.together.xyz/v1"
#   LLM_API_KEY="..."
#
# برای Local (LM Studio, LocalAI):
#   LLM_BASE_URL="http://localhost:1234/v1"
#   LLM_API_KEY="not-needed"

LLM_API_KEY=""
LLM_BASE_URL=""
LLM_MODEL="gpt-4-turbo-preview"
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0.7

# ===========================================================================
# Embedding Configuration (for Ingest project)
# ===========================================================================
# اگر با LLM یکسان است، خالی بگذارید
# در غیر این صورت می‌توانید مقادیر جداگانه بدهید

EMBEDDING_MODEL="intfloat/multilingual-e5-base"
EMBEDDING_API_KEY=""
EMBEDDING_BASE_URL=""

# ===========================================================================
# Optional Services
# ===========================================================================

# Reranking (Cohere)
COHERE_API_KEY=""
RERANKING_MODEL="rerank-multilingual-v2.0"
RERANKING_TOP_K=10

# Voice Processing (Whisper)
WHISPER_MODEL="large-v3"
WHISPER_DEVICE="cpu"
WHISPER_COMPUTE_TYPE="float16"
MAX_AUDIO_SIZE_MB=25

# OCR Settings
OCR_LANGUAGE="fas+eng"
TESSERACT_CMD="/usr/bin/tesseract"
MAX_IMAGE_SIZE_MB=10

# RAG Settings
RAG_CHUNK_SIZE=512
RAG_CHUNK_OVERLAP=50
RAG_TOP_K_RETRIEVAL=20
RAG_TOP_K_RERANK=5
RAG_SIMILARITY_THRESHOLD=0.7
RAG_MAX_CONTEXT_LENGTH=8192
RAG_USE_HYBRID_SEARCH=true
RAG_BM25_WEIGHT=0.3
RAG_VECTOR_WEIGHT=0.7

# Search Settings
SEARCH_MAX_RESULTS=50
SEARCH_TIMEOUT=30
FUZZY_MATCH_THRESHOLD=0.8

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# Monitoring
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
SENTRY_DSN=""
SENTRY_TRACES_SAMPLE_RATE=0.1

# ===========================================================================
# MinIO (External Object Storage) - REQUIRED FOR PRODUCTION
# Fill these values from your MinIO server
# ===========================================================================
S3_ENDPOINT_URL=""
S3_ACCESS_KEY_ID=""
S3_SECRET_ACCESS_KEY=""
S3_BUCKET_NAME=""
S3_REGION="us-east-1"
S3_USE_SSL=true

# External Services
INGEST_API_URL="http://localhost:8000/api"
INGEST_API_KEY=""
USERS_API_URL="http://localhost:3001/api"
USERS_API_KEY=""

# Feature Flags
ENABLE_VOICE_SEARCH=true
ENABLE_IMAGE_SEARCH=true
ENABLE_SEMANTIC_CACHE=true
ENABLE_AUDIT_LOG=true
ENABLE_CONTENT_FILTER=true
ENABLE_STREAMING=true

# Content Filtering
CONTENT_FILTER_THRESHOLD=0.8
MAX_RESPONSE_LENGTH=10000

# System Limits
MAX_CONCURRENT_REQUESTS=100
MAX_HISTORY_LENGTH=50
MAX_QUERY_LENGTH=2000
REQUEST_TIMEOUT=60

# Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=30
BACKUP_PATH="/backups"
